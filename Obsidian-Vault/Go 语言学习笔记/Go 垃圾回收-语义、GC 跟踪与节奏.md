## 1 介绍

垃圾回收器的职责是跟踪堆内存分配，释放不再需要的内存分配，并保留仍在使用的内存分配。从 Go 语言 1.12 版本开始，Go 使用了一种**非分代**的、**并发的三色标记 - 清除**垃圾回收器。

### 1.1 任务结束时一次性清理（No GC）

- 程序执行时不进行垃圾回收；执行完任务后，一次性释放所有内存。
- 非常高效，适合短生命周期任务（如 Apache 每个请求使用一个小内存池，请求结束时直接释放）。
- 不适合长生命周期服务；无法处理长时间运行中产生的垃圾。

## 2 引用计数（Reference Counting）

- 每个对象维护一个 " 引用计数 "；每次被引用则计数 +1，失效则 -1；计数为 0 时，立即释放内存。

**优点：**

- 可与现有资源管理/代码结构兼容；
    
- 对象回收立即发生，响应快；
    
- Apple 最终采用 " 自动引用计数 "（ARC）替代了 mark-sweep。

**缺点：**

- **无法处理循环引用**（典型例子：parent-child 指针）；
    
- 频繁读写计数器，有高性能开销；
    
- 多线程下不安全或难以只读共享；
    
- 回收是 " 意外地分摊 "（amortized），延迟不可控。

https://www.ardanlabs.com/blog/2018/12/garbage-collection-in-go-part1-semantics.html
